{
  "embedding": [
    -0.06626871228218079,
    -0.09906274825334549,
    -0.005915540270507336,
    -0.028349805623292923,
    0.018809901550412178,
    0.011855469085276127,
    0.017770051956176758,
    0.002321707084774971,
    0.02596280165016651,
    0.0817791298031807,
    0.039873313158750534,
    -0.040115274488925934,
    -0.045482657849788666,
    -0.03292813152074814,
    -0.01615898311138153,
    0.021742599084973335,
    -0.02636592462658882,
    -0.050557948648929596,
    -0.04956759512424469,
    0.021294470876455307,
    0.02984650246798992,
    -0.06279365718364716,
    0.11551503092050552,
    -0.024882398545742035,
    0.0667203962802887,
    -0.029597507789731026,
    -0.009897448122501373,
    -0.022708026692271233,
    0.004995543509721756,
    0.03174206614494324,
    -0.04233812168240547,
    -0.00075639842543751,
    -0.06228315830230713,
    0.029306435957551003,
    -0.01848004199564457,
    0.012977246195077896,
    -0.028779739513993263,
    -0.04993969947099686,
    -0.09072662889957428,
    0.01582453027367592,
    -0.03264949098229408,
    0.0673990547657013,
    -0.03342580795288086,
    -0.024050675332546234,
    0.015137402340769768,
    0.051788151264190674,
    0.029572855681180954,
    0.008970302529633045,
    -0.0067302631214261055,
    -0.04556601494550705,
    -0.07419326901435852,
    0.05098423734307289,
    -0.014543330296874046,
    0.0130306426435709,
    0.06996337324380875,
    0.07334809005260468,
    -0.031042618677020073,
    0.011584311723709106,
    0.04651558771729469,
    0.029540233314037323,
    0.020759332925081253,
    0.050366513431072235,
    0.02928181365132332,
    -0.03116302192211151,
    0.046584032475948334,
    0.04517604783177376,
    0.0221149530261755,
    -0.04734241962432861,
    0.09628187119960785,
    -0.03656637668609619,
    -0.09872142225503922,
    0.06985838711261749,
    0.03938021883368492,
    -0.05057496204972267,
    -0.06702186167240143,
    -0.06974112242460251,
    0.06896839290857315,
    -0.023074880242347717,
    -0.060775745660066605,
    -0.12223689258098602,
    0.058555152267217636,
    -0.04440177604556084,
    0.013097931630909443,
    -0.014767724089324474,
    0.0363907590508461,
    -0.025648225098848343,
    0.009267766028642654,
    -0.004984939470887184,
    0.026196155697107315,
    -0.017656292766332626,
    -0.025009872391819954,
    -0.03348753973841667,
    -0.015765706077218056,
    -0.007840622216463089,
    0.029627475887537003,
    -0.02184288203716278,
    0.0808078870177269,
    -0.012395812198519707,
    -0.03604165464639664,
    0.004625773523002863,
    0.04305039346218109,
    -0.08106620609760284,
    0.050379540771245956,
    0.05330885574221611,
    0.030443483963608742,
    -0.02635321207344532,
    0.03432966768741608,
    -0.007955226115882397,
    -0.08197098225355148,
    0.05919521301984787,
    0.020169533789157867,
    0.056538842618465424,
    0.0021846191957592964,
    0.038613591343164444,
    0.03873997926712036,
    0.06322142481803894,
    -0.04013093560934067,
    -0.00873073935508728,
    -0.022798709571361542,
    0.06052590161561966,
    0.08728104829788208,
    -0.013498786836862564,
    -0.00965751614421606,
    -0.0677216574549675,
    -0.02982429601252079,
    -0.0031343218870460987,
    0.11627581715583801,
    8.617990630943717e-33,
    -0.0022769866045564413,
    -0.03627846762537956,
    -0.01977238804101944,
    0.03566981106996536,
    -0.017330387607216835,
    0.03785092756152153,
    0.073086217045784,
    0.1045074537396431,
    -0.04017939791083336,
    -0.038065262138843536,
    0.008567562326788902,
    -0.044302668422460556,
    -0.02409280091524124,
    -0.019174620509147644,
    0.02186756581068039,
    -0.10287430137395859,
    0.011722778901457787,
    0.0031265774741768837,
    0.016690973192453384,
    0.02648269571363926,
    0.05967649817466736,
    -0.015950949862599373,
    -0.041166290640830994,
    0.02816222794353962,
    -0.03571702912449837,
    0.06804574280977249,
    0.04535709694027901,
    0.04513510689139366,
    -0.003895086469128728,
    -0.0006992764538154006,
    -0.05607328563928604,
    0.025886287912726402,
    0.0018432133365422487,
    -0.08274750411510468,
    -0.009251230396330357,
    -0.025063175708055496,
    0.011095352470874786,
    0.022408774122595787,
    0.018227849155664444,
    -0.09318695962429047,
    -0.08369926363229752,
    0.010303620249032974,
    -0.07421199232339859,
    -0.07070961594581604,
    0.019696326926350594,
    -0.12304225564002991,
    -0.050750602036714554,
    0.09296160936355591,
    -0.07525522261857986,
    0.034740276634693146,
    0.028673481196165085,
    -0.018232330679893494,
    -0.05110790580511093,
    -0.07372646778821945,
    -0.08331165462732315,
    -0.023673154413700104,
    0.03372999653220177,
    0.01883099600672722,
    -0.006312266457825899,
    0.04935825243592262,
    -0.0489223375916481,
    -0.024149494245648384,
    -0.02401983179152012,
    0.02838720567524433,
    -0.03609216585755348,
    0.1220623180270195,
    0.0011663567274808884,
    -0.008935458958148956,
    -0.02670505829155445,
    -0.012699216604232788,
    -0.04355011507868767,
    -0.011601513251662254,
    0.02723092772066593,
    -0.05021246522665024,
    0.04309337958693504,
    0.038987696170806885,
    -0.130933478474617,
    -0.025429196655750275,
    -0.13180948793888092,
    0.027264267206192017,
    -0.01202700100839138,
    0.052776265889406204,
    -0.02752208709716797,
    0.026336390525102615,
    0.03259604796767235,
    -0.08555296808481216,
    0.023419635370373726,
    -0.00399224366992712,
    -0.11785079538822174,
    0.05463520064949989,
    0.004745434038341045,
    -0.00045784618123434484,
    0.1100492775440216,
    -0.025370756164193153,
    0.012412206269800663,
    -8.31279335921988e-33,
    0.04568827524781227,
    -0.010699308477342129,
    -0.07597217708826065,
    0.007320348639041185,
    0.010700422339141369,
    -0.06627295166254044,
    0.02805371582508087,
    0.057244159281253815,
    -0.017394239082932472,
    -0.15331292152404785,
    -0.03311534598469734,
    -0.042591970413923264,
    -0.0980936586856842,
    0.03211710602045059,
    -0.05875980108976364,
    0.012838643044233322,
    -0.01249336451292038,
    -0.046394381672143936,
    -0.03366563096642494,
    0.05755103752017021,
    0.04362109676003456,
    0.009136729873716831,
    -0.036368515342473984,
    0.028362678363919258,
    -0.03835434839129448,
    0.10512353479862213,
    0.08905113488435745,
    0.11490420252084732,
    0.09839928895235062,
    -0.0718289390206337,
    0.09441588819026947,
    -0.08213206380605698,
    -0.0335819311439991,
    0.053656693547964096,
    0.01725177653133869,
    0.015837928280234337,
    0.017447222024202347,
    -0.03182889148592949,
    -0.12462800741195679,
    0.03691975772380829,
    0.1352056860923767,
    -0.027810249477624893,
    0.028980078175663948,
    0.006667611189186573,
    0.058566268533468246,
    0.04517059773206711,
    0.00946364738047123,
    0.046551164239645004,
    -0.10422246158123016,
    -0.0749119222164154,
    0.015518590807914734,
    0.007705658208578825,
    -0.07629232853651047,
    -0.016364416107535362,
    -0.01710921712219715,
    0.05137665942311287,
    -0.0010514948517084122,
    0.0037016025744378567,
    -0.004418275784701109,
    -0.030910756438970566,
    0.07006563246250153,
    -0.019983364269137383,
    0.0024101436138153076,
    -0.01791958510875702,
    0.07377875596284866,
    -0.02733788639307022,
    -0.014928084798157215,
    0.012134646065533161,
    0.0771448165178299,
    -0.02746002748608589,
    0.0023931493051350117,
    0.01822151243686676,
    0.0518326461315155,
    -0.07425777614116669,
    0.04909456893801689,
    0.08252590149641037,
    -0.04076506569981575,
    -0.024557221680879593,
    0.10679261386394501,
    0.0069792731665074825,
    -0.07443991303443909,
    -0.0746334120631218,
    0.040922123938798904,
    0.06773558259010315,
    -0.008306902833282948,
    0.06685436517000198,
    -0.004506030585616827,
    0.053022198379039764,
    0.07474710792303085,
    -0.059544701129198074,
    -0.056688517332077026,
    -0.031949352473020554,
    0.02085861936211586,
    0.012935124337673187,
    0.018662527203559875,
    -5.214108611539814e-8,
    -0.04556802287697792,
    0.049767836928367615,
    0.04662267863750458,
    0.02999742701649666,
    -0.06470095366239548,
    -0.07318146526813507,
    0.00917370431125164,
    0.016100183129310608,
    0.0042142802849411964,
    -0.09287412464618683,
    0.020505160093307495,
    0.044538713991642,
    0.02495500072836876,
    0.0034839182626456022,
    -0.023939935490489006,
    -0.015083076432347298,
    0.022564347833395004,
    -0.006475205533206463,
    -0.030482405796647072,
    -0.018894366919994354,
    -0.03927977755665779,
    -0.0613822340965271,
    -0.04107563570141792,
    -0.05662280693650246,
    -0.057739775627851486,
    -0.025317056104540825,
    0.0213350597769022,
    0.023615838959813118,
    0.014099028892815113,
    -0.08631826937198639,
    0.03912952542304993,
    -0.013034302741289139,
    0.06316474825143814,
    0.06045064330101013,
    -0.015221809968352318,
    0.01441639568656683,
    0.031230008229613304,
    0.0018449146300554276,
    0.1449003368616104,
    0.020914392545819283,
    0.008284828625619411,
    -0.046399638056755066,
    -0.029461275786161423,
    0.0011462443508207798,
    -0.03269544988870621,
    0.011408585123717785,
    0.02315540611743927,
    -0.02887887693941593,
    0.039579231292009354,
    0.004967210348695517,
    -0.14635591208934784,
    -0.02414165437221527,
    -0.058846648782491684,
    0.03367692232131958,
    0.07006393373012543,
    -0.0175784919410944,
    0.08444782346487045,
    -0.04737982898950577,
    -0.014894861727952957,
    0.05369821935892105,
    0.06899827718734741,
    -0.04739906266331673,
    -0.08890748023986816,
    0.08672403544187546
  ],
  "text": "**Camera Switch Preview Freeze - Complete Investigation Summary**\n\nWhen switching between front/back cameras on iOS, the camera preview shows **one frame from the new camera then freezes**. The preview doesn't continue updating with live video.\n\n### 1. State Management Fixes ‚úÖ (Working)\n- Added `cameraSwitchCount` to force widget rebuilds\n- Verified state updates correctly (logs show `switchCount` incrementing: 0 ‚Üí 1 ‚Üí 2)\n- Widget tree IS rebuilding correctly\n\n### 2. Widget Key Strategies ‚úÖ (Working)  \n- Added `ValueKey` to force widget destruction/recreation\n- Used multiple key locations (screen level + controller level)\n- Keys are changing correctly on camera switch\n\n### 3. Latest Attempt ‚è≥ (Testing)\n- Added `pausePreview()` / `resumePreview()` calls on iOS after camera initialization\n- Theory: Forces iOS to re-bind camera texture to preview widget\n\n**Evidence from Logs**:\n```\nüîÑ OLD controller state: isInitialized=true, isRecording=false, isStreaming=false\nüîÑ NEW controller initialized: CameraLensDirection.front\nüîÑ NEW controller state: isInitialized=true, isRecording=false, isStreaming=false\nüì∏ Building camera preview widget (switchCount=1)  ‚Üê Widget IS rebuilding\nüì∏ Returning CameraPreview widget with initialized controller for camera 1\n```\n\n**Key Observations**:\n1. ‚úÖ Camera controller switches correctly (back ‚Üí front)\n2. ‚úÖ Widget tree rebuilds (switchCount increments)\n3. ‚úÖ New controller is initialized (`isInitialized=true`)\n4. ‚ùå Preview shows ONE frame then freezes\n5. ‚ö†Ô∏è `isStreaming=false` on both controllers (this is normal - only true when using `startImageStream()`)\n\n**Current Code Flow**:\n```dart\n// In switchCamera():\n1. Set _controller = null\n2. Create new CameraController with new camera\n3. await controller.initialize()\n4. await controller.prepareForVideoRecording()\n5. [NEW] await controller.pausePreview() + resumePreview() on iOS\n6. Dispose old controller\n7. Notify UI to rebuild with new key\n```\n\nThis appears to be an **iOS camera plugin bug** where the native platform view texture doesn't continuously update after a camera switch, despite:\n- Controller being properly initialized\n- Widget being destroyed and recreated with new key\n- Preview widget being rebuilt\n\nThe fact that **one frame displays** proves:\n- New camera IS capturing\n- Texture IS being rendered initially\n- Something prevents subsequent frame updates\n\n1. **Known Flutter Camera Plugin Issues**:\n   - Is there a known bug with camera switching on iOS?\n   - Do other developers report \"one frame then freeze\" behavior?\n   - Are there open issues on flutter/plugins camera package?\n\n2. **iOS Platform View Limitations**:\n   - Does Flutter's PlatformView have issues with camera texture updates?\n   - Is there a known limitation with AVCaptureSession switching?\n\n3. **Workaround Patterns**:\n   - What's the recommended approach for camera switching in Flutter on iOS?\n   - Do people use different camera plugins (camera_avfoundation, etc.)?\n   - Is manual texture recreation required?\n\n4. **Similar Reports**:\n   - Search for: \"flutter camera switch freeze ios\"\n   - Search for: \"flutter camera preview one frame\"\n   - Search for: \"flutter camera platformview texture not updating\"\n\n- `camera` plugin version: 0.11.2 (latest)\n- Platform: iOS 18.7.2\n- Flutter: Latest stable\n- Specific implementation: `camera_avfoundation` (iOS backend)\n\n1. Use `pausePreview()` / `resumePreview()` (currently testing)\n2. Recreate CameraController entirely (already doing this)\n3. Use different camera plugin (camerawesome, camera_platform_interface)\n4. File bug with Flutter team if this is a known limitation\n5. Implement workaround: hide preview during switch, show loading indicator",
  "sections": [
    "Project Notes",
    "Problem Statement",
    "What We've Tried",
    "Technical Details",
    "Hypothesis",
    "Questions for Research",
    "Files to Investigate",
    "Potential Solutions to Research"
  ],
  "timestamp": 1762757509189,
  "path": "/Users/rabble/code/andotherstuff/openvine/mobile/.private-journal/2025-11-10/07-51-49-189811.md"
}