---
title: "9:45:38 PM - November 27, 2025"
date: 2025-11-27T08:45:38.873Z
timestamp: 1764233138873
---

## Project Notes

## Blossom Base64 Encoding Investigation (2025-11-27)

### Summary
Investigated whether blossom.divine.video requires standard base64 or base64Url encoding.

### Key Findings
1. **Official Specs (BUD-01, NIP-98)**: Both say "base64 encoded" - this means STANDARD base64
2. **Official SDKs**:
   - blossom-client-sdk (JS): uses `btoa()` = standard base64
   - nostr-blossom (Rust): uses `STANDARD` base64
3. **Local nostr_sdk**: Uses `base64Url.encode()` at lib/upload/blossom_uploader.dart:90 - contradicts spec!
4. **Local uncommitted change**: blossom_upload_service.dart has uncommitted change from `base64.encode` to `base64Url.encode`

### Live Test Results
- Created integration test at test/integration/blossom_encoding_live_test.dart
- Test was INCONCLUSIVE because:
  - Generated Nostr events (JSON with hex strings) rarely produce `+` or `/` in base64
  - After 50+ attempts, encodings were always identical
  - All requests (standard, URL-safe, no auth) got 401 - suggesting other auth issues (maybe need `x` tag, whitelisted pubkey, etc.)

### Conclusion
Based on spec conformance and official SDK analysis:
- The local change to base64Url should probably be REVERTED
- The specs clearly say "base64" (standard)
- The nostr_sdk library's use of base64Url is non-standard
- Since most real events don't contain +/- characters, this rarely causes issues in practice
