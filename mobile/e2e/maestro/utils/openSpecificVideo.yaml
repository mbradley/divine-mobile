appId: co.openvine.app
---
#Util TC to open a specific video based on its description,
# given the user is logged in in the app,,
# validate the like is on for the video "when you jammin to JB"
#Steps:
# 1. Tap on Explore and then on Search: Validate search screen
# 2. Input text "when you jammin to JB": Validate video is found
# 3. Tap on the 1st video returned: Validate playback

# 1. Tap on Explore and then on Search: Validate search screen
- doubleTapOn:
    id: explore_tab
    delay: 100
- tapOn: Search
- runFlow: ../asserts/assertSearch.yaml

# 2. Input text ${VIDEO_SEARCH_TERM}: Validate video is found
- tapOn: Find something cool...

# Dismiss Android stylus modal if it appears
- runFlow:
    when:
      visible: Try out your stylus
    commands:
      - tapOn: Cancel

- inputText: ${VIDEO_SEARCH_TERM}
# Retry loop: if VIDEO_DESCRIPTION not visible, erase and re-type
- repeat:
    while:
      notVisible: ${VIDEO_DESCRIPTION}
    commands:
      - eraseText
      - waitForAnimationToEnd:
          timeout: 10000
      - inputText: ${VIDEO_SEARCH_TERM}

#TO-DO: once search is fixed remove this workaround
#- runFlow: ../utils/searchWorkaround.yaml
#Assert Videos result
- assertVisible:
    text: "Videos \\((?!0)\\d+\\)\\nTab 1 of 3"

# 3. Tap on the 1st video returned: Validate playback screen
- tapOn:
    text: ".* ${VIDEO_DESCRIPTION} .*"
- waitForAnimationToEnd:
    timeout: 3000
- tapOn:
    point: 50%,50%
- runFlow: ../asserts/assertVideoPaused.yaml
